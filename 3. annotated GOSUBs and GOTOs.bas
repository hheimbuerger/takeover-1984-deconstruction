// *** Initialization ***
5 REM 'MILITARY COUP' WALWYN
10 GOSUB 7000  // 7000 = Colour Codes for Commodore 64
12 DIM W$(5), WF$(5)
13 FOR J = 1 TO 5: READ W$(J): NEXT J
14 DATA COMMUNIST, SOCIALIST, LIBERAL, RIGHTWING, FASCIST
15 FOR J = 1 TO 5: READ WF$(J): NEXT J
16 DATA WILL, PROBABLY WILL
17 DATA MIGHT, PROBABLY WON'T
18 DATA WILL NOT
19 GOSUB 6000  // 6000 = Instructions

// *** Set Up Initial Data ***
20 REM *** SET UP INITIAL DATA ***
22 DIM B$(15), L(15), G(15), S(15), B(15)
24 REM B$...THE NAME OF THE BUILDINGS
26 REM L....THE POLITICAL LEANING (1-5)
28 REM G....PRO-GOVERNMENT (-2 TO +6)
30 REM S....POINTS
32 REM B....RESULTANT LOYALTY TO XERXES (1-5)
35 DIM M5(8, 12), B5(8, 12)
36 REM M5 = +1: GOVT -1: ME. B5 = BUILDING SUBSCRIPT NUMBER

// *** Game Start ***
39 POKE UG, U1
40 PRINT UF$; "�AT THE START OF THE GAME, WILL ANY OF "
41 PRINT "THE FOLLOWING BUILDINGS JOIN THE REBELS?"
42 PRINT U5$; "(MAKE A NOTE OF THE LIKELY TARGETS!)"
44 PRINT: FOR J = 1 TO 15
45 READ B$(J), L(J), G(J), S(J)
50 D$ = U3$: B(J) = 3 - ABS(L(J) - G1) + ABS(L(J) - P1) + G(J)
52 B = INT(B(J) + G2 - P2): IF B >= 5 THEN B = 5: D$ = UN$
53 IF B <= 1 THEN B = 1: D$ = UM$
55 PRINT D$; "THE "; LEFT$(B$(J), 1); "�";
57 PRINT RIGHT$(B$(J), LEN(B$(J)) - 1); " " WF$(B)
58 NEXT J

// *** Building Data ***
61 DATA GOVERNMENT BUILDING, 3, 2, 3
62 DATA RADIO STATION, 3, 0, 3
63 DATA NEWSPAPER OFFICE, 3, 0, 2
64 DATA POLICE STATION, 4, 2, 5
65 DATA MILITARY HQ, 5, 1, 8
66 DATA TRADES UNION, 1, 0, 5
67 DATA XERXES PALACE, 3, 6, 9
68 DATA UNIVERSITY, 1, -2, 4
69 DATA AIRPORT, 4, 1, 3
70 DATA HOSPITAL, 3, 0, 2
71 DATA BANK, 3, 3, 1
72 DATA SHOPPING CENTRE, 4, 2, 1
73 DATA CATHEDRAL, 3, -1, 2
74 DATA FACTORY, 2, 1, 3
75 DATA JAIL, 3, -2, 1

// *** Initialize Map ***
78 FOR J = 1 TO 7: FOR K = 1 TO 11: M5(J, K) = 0: B5(J, K) = 0: NEXT K, J
80 D1$ = "�ߒ �����������"
81 D2$ = CHR$(172) + CHR$(162) + CHR$(187) + "���" + CHR$(161)
82 D2$ = D2$ + CHR$(32) + "�" + CHR$(161) + "���" + CHR$(188)
83 D2$ = D2$ + "" + CHR$(162) + "�" + CHR$(190)
84 X$ = ""
85 Y$ = ""

// *** Set Up Map ***
86 REM SET UP MAP
87 FOR J = 1 TO 15
88 X = INT(RND(1) * 5 + 1) * 2: Y = INT(RND(1) * 3 + 1) * 2: IF B5(Y, X) <> 0 THEN 88
89 B5(Y, X) = J: NEXT J: PRINT "PRESS ANY KEY TO START"
90 GOSUB 8000: PRINT "�": POKE UB, U3: POKE UG, U1: GOSUB 8100  // 8000 = Wait for Key Press, 8100 = Draw Map of Buildings

// *** Main Game Loop ***
95 GOSUB 8300: GOTO 98  // 8300 = Display Popularity Bar Chart, 98 = Main Game Loop
96 GOSUB 3000  // 3000 = News Event
98 FOR Q = 1 TO 4
100 GOSUB 8200: A$ = "": B$ = "": N1 = 0: GOSUB 9000  // 8200 = Clear Screen, 9000 = Display Move Number
145 X = 0: Y = 0
150 GOSUB 8000  // 8000 = Wait for Key Press
180 IF ASC(A$) > 64 AND ASC(A$) < 76 THEN X = ASC(A$) - 64: GOTO 196
185 IF X <> 0 AND A > 0 AND A < 8 THEN Y = A: GOTO 200
190 IF A$ = "�" THEN 400: REM FUNC.1 PRESSED
192 IF A$ = "�" THEN 500: REM FUNC.3 PRESSED
194 IF A$ = "�" THEN 600: REM FUNC.5 PRESSED
195 GOTO 150
196 PRINT U0$; "" A$: B$ = A$
197 GOTO 150
198 NEXT Q: GOTO 1000

// *** Handle Building Activation ***
200 GOSUB 8200: PRINT U6$; "";  // 8200 = Clear Screen
205 IF B5(Y, X) <> 0 THEN 210
206 GOTO 215
210 PRINT "THERE'S A BUILDING ON SQUARE " B$; A$: GOSUB 8050  // 8050 = Display Message and Wait for Key Press
212 GOTO 100
215 IF M5(Y, X) < 0 THEN 220
216 GOTO 225
220 PRINT "YOU ALREADY HOLD SQUARE " B$; A$: GOSUB 8050  // 8050 = Display Message and Wait for Key Press
222 GOTO 100
225 REM OK TO TAKE
230 FOR K = 1 TO 2: D9$ = U1$: GOSUB 8110: D9$ = "": GOSUB 8110: NEXT K  // 8110 = Draw Map of Buildings
235 B = M5(Y - 1, X) + M5(Y + 1, X) + M5(Y, X + 1) + M5(Y, X - 1)
237 B = B + M5(Y - 1, X - 1) + M5(Y + 1, X + 1) + M5(Y - 1, X + 1) + M5(Y + 1, X - 1)
240 IF B < 0 THEN 300
250 PRINT U0$; "SQUARE " B$; A$; "� DOES NOT JOIN THE REVOLUTION"
260 GOSUB 8050: GOTO 1000  // 8050 = Display Message and Wait for Key Press, 1000 = End of My Go
300 REM SQUARE CHANGES HANDS
310 M5(Y, X) = -1: GOSUB 8110  // 8110 = Draw Map of Buildings
320 GOTO 198  // 198 = Main Game Loop

// *** Activate a Building ***
400 REM ACTIVATE A BUILDING UNLESS N = 1 THEN INFORMATION
410 GOSUB 8200  // 8200 = Clear Screen
415 IF N1 = 0 THEN 420
416 PRINT U6$; "INFORMATION ABOUT WHICH BUILDING?"
417 GOTO 425
420 PRINT UF$; "WHICH BUILDING DO YOU WISH TO ACTIVATE? "
425 PRINT "(TYPE INITIAL LETTER OF BUILDING ONLY)  "
430 GOSUB 8000  // 8000 = Wait for Key Press
435 FOR J = 1 TO 15: IF LEFT$(B$(J), 1) = A$ THEN 440
436 NEXT J: PRINT U0$; "THERE IS NO SUCH BUILDING AS '" A$ "'        "
437 GOSUB 8050: GOTO 100  // 8050 = Display Message and Wait for Key Press
440 FOR X = 2 TO 10 STEP 2: FOR Y = 2 TO 6 STEP 2
441 IF B5(Y, X) = J THEN 443
442 NEXT Y: NEXT X: GOTO 100
443 B = M5(Y - 1, X) + M5(Y + 1, X) + M5(Y, X + 1) + M5(Y, X - 1)
444 B = B + M5(Y - 1, X - 1) + M5(Y + 1, X + 1) + M5(Y - 1, X + 1) + M5(Y + 1, X - 1)
448 B = INT(B(J) + B / 2 + G2 - P2): IF B < 1 THEN B = 1
449 IF B > 5 THEN B = 5
450 GOSUB 8200  // 8200 = Clear Screen
455 PRINT UF$; "THE " B$(J)
456 IF M5(Y, X) >= 0 THEN 460
457 PRINT "IS ALREADY ON YOUR SIDE!"
458 GOSUB 8050: GOTO 100  // 8050 = Display Message and Wait for Key Press
460 PRINT "" WF$(B); " JOIN THE REBELS."
462 GOSUB 8050: IF N1 = 1 THEN 100  // 8050 = Display Message and Wait for Key Press
470 FOR K = 1 TO 3: D9$ = U1$: GOSUB 8110: D9$ = U0$: GOSUB 8110: NEXT K  // 8110 = Draw Map of Buildings
472 GOSUB 8200  // 8200 = Clear Screen
473 K = INT(RND(1) * 3 + 2)
474 IF B < K THEN 480
475 IF B > K THEN 490
476 PRINT UF$; "THE " B$(J)
477 PRINT "WISHES TO BE NEUTRAL FOR THE MOMENT."
478 IF M5(Y, X) > 0 THEN G3 = G3 - S(J): G2 = G2 - .15
479 M5(Y, X) = 0: GOSUB 8110: GOSUB 8350: GOSUB 8050: GOTO 1000  // 8110 = Draw Map of Buildings, 8350 = Display Popularity Bar Chart, 8050 = Display Message and Wait for Key Press
480 PRINT UM$; "THE " B$(J)
482 PRINT "VOTES TO JOIN THE REBELS!"
483 P3 = P3 + S(J): IF M5(Y, X) > 0 THEN G3 = G3 - S(J)
484 M5(Y, X) = -1: GOSUB 8110  // 8110 = Draw Map of Buildings
485 P2 = P2 + .125: G2 = G2 - .125: GOSUB 8350  // 8350 = Display Popularity Bar Chart
486 GOSUB 8050: GOTO 198  // 8050 = Display Message and Wait for Key Press, 198 = Main Game Loop
490 PRINT UN$; "THE " B$(J)
492 PRINT "SIDES WITH THE GOVERNMENT FORCES."
493 G3 = G3 + S(J): IF M5(Y, X) < 0 THEN P3 = P3 - S(J)
494 M5(Y, X) = 1: GOSUB 8110  // 8110 = Draw Map of Buildings
495 G2 = G2 + .125: P2 = P2 - .125: GOSUB 8350  // 8350 = Display Popularity Bar Chart
496 GOSUB 8050: GOTO 1000  // 8050 = Display Message and Wait for Key Press, 1000 = End of My Go

// *** Information ***
500 REM INFORMATION
510 N1 = 1: GOTO 400

// *** End of Turn ***
600 GOTO 1000
999 END
1000 REM END OF MY GO

// *** Computer Turn ***
2000 REM COMPUTER GO
2001 GOSUB 3000  // 3000 = News Event
2002 FOR Q = 1 TO 4
2005 GOSUB 8200  // 8200 = Clear Screen
2010 PRINT UN$; "GOVERNMENT MOVE NO." Q
2020 FOR L = 1 TO 15
2030 X = INT(RND(1) * 5 + 1) * 2: Y = INT(RND(1) * 3 + 1) * 2
2035 J = B5(Y, X)
2036 IF M5(Y, X) > 0 THEN 2030
2038 B = M5(Y - 1, X) + M5(Y + 1, X) + M5(Y, X + 1) + M5(Y, X - 1)
2039 B = B + M5(Y - 1, X - 1) + M5(Y + 1, X + 1) + M5(Y - 1, X + 1) + M5(Y + 1, X - 1)
2040 B = INT(B(J) + B / 2 + G2 - P2): IF B < 1 THEN B = 1
2045 IF B > 5 THEN B = 5
2050 IF B >= (5 - Q / 2) THEN 2200
2090 NEXT L: GOTO 2100
2097 NEXT Q: GOTO 96  // 96 = Main Game Loop

// *** Government Calculates a Square ***
2100 REM GOVERNMENT CALCULATES A SQUARE
2102 FOR L = 1 TO 100
2105 X = INT(RND(1) * 11) + 1: Y = INT(RND(1) * 7) + 1
2110 IF M5(Y, X) > 0 OR B5(Y, X) > 0 THEN 2105
2115 B = M5(Y - 1, X) + M5(Y + 1, X) + M5(Y, X + 1) + M5(Y, X - 1)
2117 B = B + M5(Y - 1, X - 1) + M5(Y + 1, X + 1) + M5(Y - 1, X + 1) + M5(Y + 1, X - 1)
2120 IF B > 0 THEN 2600
2125 NEXT L
2130 GOTO 2097

// *** Computer Activates a Building ***
2200 REM COMPUTER ACTIVATES A BUILDING
2210 PRINT UF$; "...IS TO ACTIVATE"
2220 PRINT "THE " B$(J) " WHICH IT THINKS"
2230 PRINT "" WF$(6 - B) " JOIN THE GOVERNMENT."
2250 FOR K = 1 TO 6: D9$ = U1$: GOSUB 8110: D9$ = U0$: GOSUB 8110: NEXT K  // 8110 = Draw Map of Buildings
2252 GOSUB 8200  // 8200 = Clear Screen
2255 K = INT(RND(1) * 3 + 2)
2256 IF B < K THEN 2270
2257 IF B > K THEN 2280
2260 PRINT UF$; "THE " B$(J)
2262 PRINT "WISHES TO BE NEUTRAL FOR THE MOMENT."
2263 IF M5(Y, X) < 0 THEN P3 = P3 - S(J): P2 = P2 - .15
2264 M5(Y, X) = 0: GOSUB 8110  // 8110 = Draw Map of Buildings
2267 GOSUB 8350  // 8350 = Display Popularity Bar Chart
2268 GOSUB 8050: GOTO 96  // 8050 = Display Message and Wait for Key Press, 96 = Main Game Loop
2270 PRINT UM$; "THE " B$(J)
2272 PRINT "VOTES TO JOIN THE REBELS!"
2274 P3 = P3 + S(J): IF M5(Y, X) > 0 THEN G3 = G3 - S(J)
2275 M5(Y, X) = -1: GOSUB 8110  // 8110 = Draw Map of Buildings
2276 P2 = P2 + .125: G2 = G2 - .125: GOSUB 8350  // 8350 = Display Popularity Bar Chart
2278 GOSUB 8050: GOTO 96  // 8050 = Display Message and Wait for Key Press, 96 = Main Game Loop
2280 PRINT UN$; "THE " B$(J)
2282 PRINT "SIDES WITH THE GOVERNMENT FORCES."
2284 G3 = G3 + S(J): IF M5(Y, X) < 0 THEN P3 = P3 - S(J)
2286 M5(Y, X) = 1: GOSUB 8110  // 8110 = Draw Map of Buildings
2287 G2 = G2 + .125: P2 = P2 - .125: GOSUB 8350  // 8350 = Display Popularity Bar Chart
2288 GOSUB 8050: GOTO 2097  // 8050 = Display Message and Wait for Key Press, 2097 = Government Calculates a Square

// *** Computer Takes Over a Square ***
2600 REM COMPUTER TAKES OVER A SQUARE
2610 FOR K = 1 TO 2: D9$ = U1$: GOSUB 8110: D9$ = "": GOSUB 8110: NEXT K  // 8110 = Draw Map of Buildings
2620 M5(Y, X) = 1: GOSUB 8110: GOSUB 8050  // 8110 = Draw Map of Buildings, 8050 = Display Message and Wait for Key Press
2630 GOTO 2097  // 2097 = Government Calculates a Square

// *** News Event ***
3000 REM NEWS EVENT
3002 GOSUB 8200  // 8200 = Clear Screen
3005 N$ = "AND NOW HERE IS THE NEWS................"
3010 FOR J = 1 TO LEN(N$): PRINT U0$; MID$(N$, J, 1);
3012 POKE UV, 15: POKE UA, 9: POKE UD, 0: POKE UH, 30
3014 POKE UL, 0: POKE UW, 129
3020 POKE UV, 0: POKE UA, 0: POKE UD, 0: POKE UH, 0: POKE UL, 0: POKE UW, 0
3025 NEXT J
3050 K = INT(RND(1) * 10 + 1)
3055 PRINT: GOSUB 8200  // 8200 = Clear Screen
3060 ON K GOSUB 3090, 3090, 3090, 3092, 3092, 3094, 3096, 3097, 3098, 3099
3070 FOR X = 2 TO 10 STEP 2: FOR Y = 2 TO 6 STEP 2
3072 IF B5(Y, X) = J THEN 3080
3074 NEXT Y: NEXT X: GOTO 3050
3080 FOR L = 1 TO 4: D9$ = U1$: GOSUB 8110: D9$ = "": GOSUB 8110: NEXT L  // 8110 = Draw Map of Buildings
3083 IF M5(Y, X) = 0 AND J <> 13 THEN 3800
3085 M5 = 0: PRINT "" UM$;: IF M5(Y, X) > 0 THEN PRINT UN$;: M5 = 1
3086 PRINT "THE " B$(J) "                           "
3089 ON K GOTO 3100, 3100, 3100, 3200, 3200, 3300, 3400, 3500, 3600, 3700

// *** News Event Handlers ***
3090 J = 2: RETURN
3092 J = 3: RETURN
3094 J = 9: RETURN
3096 J = 13: RETURN
3097 J = 10: RETURN
3098 J = 7: RETURN
3099 J = 11: RETURN

// *** Radio Station ***
3100 REM RADIO STATION
3110 IF M5 = 1 THEN 3130
3120 PRINT "MAKES A PRO-REBEL BROADCAST"
3125 GOTO 3140
3130 PRINT "MAKES A PRO-GOVERNMENT BROADCAST"
3140 GOSUB 8050: GOSUB 8200
3150 IF M5 = 1 THEN 3170
3160 FOR K = 1 TO 20: GOSUB 4200: NEXT K: GOSUB 8050: RETURN  // 4200 = Government Forces Change Sides, 8050 = Display Message and Wait for Key Press
3170 FOR K = 1 TO 20: GOSUB 4300: NEXT K: GOSUB 8050: RETURN  // 4300 = Rebel Forces Change Sides, 8050 = Display Message and Wait for Key Press

// *** Newspaper Office ***
3200 REM NEWSPAPER OFFICE
3210 IF M5 = 1 THEN 3230
3220 PRINT "RELEASES A PRO-REBEL NEWSFLASH"
3225 GOTO 3240
3230 PRINT "RELEASES A PRO-GOVERNMENT NEWSFLASH"
3240 GOSUB 8050: GOSUB 8200
3250 IF M5 = 1 THEN 3270
3260 FOR K = 1 TO 12: GOSUB 4200: NEXT K: GOSUB 8050: RETURN  // 4200 = Government Forces Change Sides, 8050 = Display Message and Wait for Key Press
3270 FOR K = 1 TO 12: GOSUB 4300: NEXT K: GOSUB 8050: RETURN  // 4300 = Rebel Forces Change Sides, 8050 = Display Message and Wait for Key Press

// *** Airport ***
3300 REM AIRPORT
3310 IF M5 = 1 THEN 3330
3320 PRINT "FLIES SUPPLIES IN TO THE REBELS"
3325 GOTO 3340
3330 PRINT "FLIES SUPPLIES IN TO THE GOVERNMENT"
3340 GOSUB 8050: GOSUB 8200
3350 IF M5 = 1 THEN 3370
3360 GOSUB 4000: GOSUB 8050: RETURN  // 4000 = Government Popularity Drops, 8050 = Display Message and Wait for Key Press
3370 GOSUB 4100: GOSUB 8050: RETURN  // 4100 = Rebel Popularity Drops, 8050 = Display Message and Wait for Key Press

// *** Cathedral ***
3400 REM CATHEDRAL
3402 IF M5(Y, X) <> 0 THEN 3410
3405 PRINT UF$; "MAKES A PLEA FOR AN END TO HOSTILITIES"
3408 GOTO 3440
3410 IF M5 = 1 THEN 3430
3420 PRINT "PREACHES A PRO-REBEL SERMON"
3425 GOTO 3440
3430 PRINT "PREACHES A PRO-GOVERNMENT SERMON"
3440 GOSUB 8050: GOSUB 8200
3450 IF M5(Y, X) = 0 THEN FOR K = 1 TO 20: GOSUB 4400: NEXT K: GOSUB 8050: RETURN  // 4400 = Random Forces Desert, 8050 = Display Message and Wait for Key Press
3455 IF M5 = 1 THEN 3470
3460 FOR K = 1 TO 10: GOSUB 4200: NEXT K: GOSUB 8050: RETURN  // 4200 = Government Forces Change Sides, 8050 = Display Message and Wait for Key Press
3470 FOR K = 1 TO 10: GOSUB 4300: NEXT K: GOSUB 8050: RETURN  // 4300 = Rebel Forces Change Sides, 8050 = Display Message and Wait for Key Press

// *** Hospital ***
3500 REM HOSPITAL
3510 IF M5 = 1 THEN 3530
3520 PRINT "GIVES HELP TO THE REBEL FORCES"
3525 GOTO 3540
3530 PRINT "GIVES HELP TO THE GOVERNMENT FORCES"
3540 GOSUB 8050: GOSUB 8200
3550 IF M5 = 1 THEN 3570
3560 GOSUB 4000: GOSUB 8050: RETURN  // 4000 = Government Popularity Drops, 8050 = Display Message and Wait for Key Press
3570 GOSUB 4100: GOSUB 8050: RETURN  // 4100 = Rebel Popularity Drops, 8050 = Display Message and Wait for Key Press

// *** Xerxes Palace ***
3600 REM XERXES PALACE
3610 IF M5 = 1 THEN 3630
3620 PRINT "RECEIVES REBEL REINFORCEMENTS"
3625 GOTO 3640
3630 PRINT "RECEIVES GOVERNMENT REINFORCEMENTS"
3640 GOSUB 8050: GOSUB 8200
3650 IF M5 = 1 THEN 3670
3660 FOR K = 1 TO 12: GOSUB 4200: NEXT K: GOSUB 8050: RETURN  // 4200 = Government Forces Change Sides, 8050 = Display Message and Wait for Key Press
3670 FOR K = 1 TO 12: GOSUB 4300: NEXT K: GOSUB 8050: RETURN  // 4300 = Rebel Forces Change Sides, 8050 = Display Message and Wait for Key Press

// *** Bank ***
3700 REM BANK
3710 IF M5 = 1 THEN 3730
3720 PRINT "FREEZES GOVERNMENT ASSETS"
3725 GOTO 3740
3730 PRINT "FREEZES REBEL ASSETS"
3740 GOSUB 8050: GOSUB 8200
3750 IF M5 = 1 THEN 3770
3760 GOSUB 4000: GOSUB 8050: RETURN  // 4000 = Government Popularity Drops, 8050 = Display Message and Wait for Key Press
3770 GOSUB 4100: GOSUB 8050: RETURN  // 4100 = Rebel Popularity Drops, 8050 = Display Message and Wait for Key Press

// *** No News ***
3800 REM NO NEWS
3805 GOSUB 8200
3810 PRINT UF$; "";
3820 PRINT "THE " B$(J) " REPORTS THAT"
3830 PRINT "ALL REMAINS CALM."
3840 GOSUB 8050  // 8050 = Display Message and Wait for Key Press
3850 RETURN

// *** Government Popularity Drops ***
4000 REM GOVERNMENT POPULARITY DROPS
4010 PRINT UM$; "GOVERNMENT POPULARITY FALLS..........."
4020 G2 = G2 - .2: P2 = P2 + .2: GOSUB 8350: RETURN  // 8350 = Display Popularity Bar Chart

// *** Rebel Popularity Drops ***
4100 REM REBEL POPULARITY DROPS
4110 PRINT UN$; "REBEL POPULARITY FALLS..........."
4120 P2 = P2 - .2: G2 = G2 + .2: GOSUB 8350: RETURN  // 8350 = Display Popularity Bar Chart

// *** Government Forces Change Sides ***
4200 REM GOVERNMENT FORCES CHANGE SIDES
4210 PRINT UM$; "SOME GOVERNMENT FORCES MAY CHANGE SIDES"
4220 X = INT(RND(1) * 11) + 1: Y = INT(RND(1) * 7) + 1
4225 IF M5(Y, X) <= 0 OR B5(Y, X) > 0 THEN RETURN
4240 D9$ = U1$: GOSUB 8110: D9$ = "": GOSUB 8110  // 8110 = Draw Map of Buildings
4245 M5(Y, X) = -1
4250 D9$ = U1$: GOSUB 8110: D9$ = "": GOSUB 8110  // 8110 = Draw Map of Buildings
4260 RETURN

// *** Rebel Forces Change Sides ***
4300 REM REBEL FORCES CHANGE SIDES
4310 PRINT UN$; "SOME REBEL FORCES MAY CHANGE SIDES"
4320 X = INT(RND(1) * 11) + 1: Y = INT(RND(1) * 7) + 1
4325 IF M5(Y, X) >= 0 OR B5(Y, X) > 0 THEN RETURN
4340 D9$ = U1$: GOSUB 8110: D9$ = "": GOSUB 8110  // 8110 = Draw Map of Buildings
4345 M5(Y, X) = 1
4350 D9$ = U1$: GOSUB 8110: D9$ = "": GOSUB 8110  // 8110 = Draw Map of Buildings
4360 RETURN

// *** Random Forces Desert ***
4400 REM RANDOM FORCES DESERT
4410 PRINT UF$; "SOME FORCES FROM EITHER SIDE MAY DESERT"
4420 X = INT(RND(1) * 11) + 1: Y = INT(RND(1) * 7) + 1
4425 IF M5(Y, X) = 0 OR B5(Y, X) > 0 THEN RETURN
4440 D9$ = U1$: GOSUB 8110: D9$ = "": GOSUB 8110  // 8110 = Draw Map of Buildings
4445 M5(Y, X) = 0
4450 D9$ = U1$: GOSUB 8110: D9$ = "": GOSUB 8110  // 8110 = Draw Map of Buildings
4460 RETURN

// *** Instructions ***
6000 REM *** INSTRUCTIONS ***
6010 POKE UG, UF: POKE UB, U6: PRINT "�"; U7$;
6020 PRINT "M I L I T A R Y   C O U P"
6050 PRINT U8$; "IN THIS GAME YOU ATTEMPT TO TAKE OVER"
6060 PRINT "THE GOVERNMENT HEADED BY THE EVIL"
6062 PRINT "PRESIDENT XERXES. THE GAME IS PLAYED ON"
6065 PRINT "A CITY MAP WHICH FEATURES STREETS"
6070 PRINT "AND BUILDINGS. YOU ARE THE REBEL FORCES
6075 PRINT "AND THE GOVERNMENT IS PLAYED BY THE "
6080 PRINT "COMPUTER. POINTS ARE GAINED BY"
6085 PRINT "CAPTURING KEY BUILDINGS AND THE FIRST"
6090 PRINT "PLAYER TO REACH 35� POINTS IS THE WINNER."
6095 PRINT U9$; "             PRESS ANY KEY              "
6097 GOSUB 8000  // 8000 = Wait for Key Press
6100 PRINT U8$; "�YOU AND I EACH TAKE ALTERNATE TURNS."
6110 PRINT "EACH TURN CONSISTS OF FOUR CONSECUTIVE"
6120 PRINT "MOVES. IF EITHER IS UNSUCCESSFUL IN ANY"
6130 PRINT "MOVE, PLAY REVERTS TO THE OTHER."
6140 PRINT "AT EACH MOVE YOU MAY EITHER:"
6145 PRINT U7$; "1) TRY TO TAKE OVER A BUILDING SQUARE "
6150 PRINT U8$; "   EACH BUILDING HAS A TRADITIONAL   "
6152 PRINT "   POLITICAL LEANING, LOYALTY AND"
6155 PRINT "   PRO/ANTI GOVERNMENT BIAS BUT THIS"
6160 PRINT "   WILL CHANGE AS THE GAME PROGRESSES"
6165 PRINT "   ACCORDING TO YOUR POPULARITY."
6170 PRINT "   THE MORE POPULAR YOU ARE, THE BETTER"
6175 PRINT "   THE CHANCE OF A BUILDING COMING OVER"
6180 PRINT "   TO YOUR SIDE.
6185 PRINT U7$; "2) TRY TO TAKE OVER A STREET SQUARE"
6190 PRINT U8$; "   THIS WILL ALSO HELP YOU TO TAKE   "
6191 PRINT U8$; "   OVER BUILDINGS AT A LATER DATE."
6192 PRINT U8$; "   IT WILL ALSO HELP STOP GOVERNMENT"
6194 PRINT U8$; "   FORCES FROM ADVANCING TOO FAR."
6195 PRINT "             PRESS ANY KEY              ";
6197 GOSUB 8000  // 8000 = Wait for Key Press
6200 PRINT U5$: PRINT "�TAKING OVER A STREET SQUARE IS ONLY"
6210 PRINT "POSSIBLE IF YOU ALREADY OCCUPY MORE"
6220 PRINT "SURROUNDING SQUARES (UP TO " U8$ "8 " U5$; "BUILDINGS"
6230 PRINT "OR STREETS) THAN THE OPPOSING COLOUR."
6240 PRINT "GREY NEUTRAL SQUARES DO NOT COUNT."
6250 PRINT "THE MORE SQUARES YOU OCCUPY SURROUNDING"
6255 PRINT "A BUILDING, THE MORE CHANCE YOU HAVE OF"
6260 PRINT "OVERCOMING RESISTANCE IN A BUILDING."
6270 PRINT U8$; "SOME BUILDINGS ARE PARTICULARLY "
6275 PRINT "IMPORTANT SINCE THEY CAN ALTER THE "
6280 PRINT "COURSE OF THE GAME IF YOU OCCUPY THEM."
6290 PRINT "THESE INCLUDE: " U3$; "THE RADIO STATION (R)
6292 PRINT "               THE NEWSPAPER OFFICE (N)
6294 PRINT "               THE CATHEDRAL (C)
6296 PRINT "               THE BANK (B)"
6298 PRINT "               THE HOSPITAL (H)"
6300 PRINT "               THE AIRPORT (A)"
6305 PRINT "           AND XERXES' PALACE (X)"
6310 PRINT U7$ "THE RADIO STATION, NEWSPAPER OFFICE AND"
6315 PRINT "CATHEDRAL ARE THE MOST IMPORTANT"
6320 PRINT "BUILDINGS TO HOLD BUT YOU WILL PROBABLY"
6325 PRINT "NEVER MANAGE TO CAPTURE XERXES' PALACE!"
6330 PRINT U5$; "             PRESS ANY KEY              ";
6335 GOSUB 8000  // 8000 = Wait for Key Press
6350 PRINT: PRINT "�BEFORE EACH TURN, ONE OF THESE"
6355 PRINT "BUILDINGS MAY RELEASE A NEWSFLASH"
6360 PRINT "WHICH MAY BE DAMAGING IF IT IS"
6365 PRINT "HELD BY ENEMY FORCES."
6370 PRINT "TO HELP YOU FIND OUT IF A BUILDING"
6375 PRINT "MAY BE RIPE FOR CAPTURE, YOU HAVE A"
6380 PRINT "FREE OPTION TO EXAMINE INTELLIGENCE"
6385 PRINT "REPORTS BY PRESSING 'F3'."
6390 PRINT U7$ "GOOD LUCK. THE POINTS FOR CAPTURING
6395 PRINT U7$ "OR SUCCESSFULLY RESISTING AN ATTACK"
6400 PRINT U7$ "ON A BUILDING ARE PRINTED ON THE "
6410 PRINT U7$ "FRONT OF THE BUILDING NEXT TO THE "
6420 PRINT U7$ "LETTER OF IDENTIFICATION."
6422 PRINT "EACH TIME A BUILDING CHANGES HANDS, "
6424 PRINT "THE POPULARITY CHART WILL BE AFFECTED."
6425 PRINT "             PRESS ANY KEY              ";
6427 GOSUB 8000: PRINT  // 8000 = Wait for Key Press
6430 PRINT U8$ "�EACH GAME WILL BE A DIFFERENT SCENARIO."
6432 PRINT "NOT ONLY WILL THE CITY MAP BE CHANGED,"
6435 PRINT "YOU CAN CHOOSE WHETHER YOU WISH TO BE"
6440 PRINT "LEFT OR RIGHT WING. REMEMBER THAT THE"
6445 PRINT "ALLEGIANCES OF EACH BUILDING WILL"
6450 PRINT "BE DIFFERENT. IT ALL DEPENDS ON YOUR"
6455 PRINT "POLITICAL COLOUR AS WELL AS THE"
6460 PRINT "GOVERNMENT'S POLITICS AND STRENGTH."
6470 PRINT "WATCH OUT. THE GOVERNMENT WILL PLAY"
6475 PRINT "A MEAN GAME! NOBODY LIKES TO LOSE."
6495 PRINT "             PRESS ANY KEY              ";
6497 GOSUB 8000  // 8000 = Wait for Key Press
6500 PRINT "�"
6505 PRINT U5$; "SO FIRST OF ALL, DEFINE THE SCENARIO..."
6510 PRINT "DO YOU WANT TO TRY TO OVERTHROW A..."
6520 PRINT UU$; "1...COMMUNIST GOVERNMENT"
6530 PRINT "2...SOCIALIST GOVERNMENT"
6540 PRINT "3...LIBERAL   GOVERNMENT"
6550 PRINT "4...RIGHTWING GOVERNMENT"
6560 PRINT "5...FASCIST   GOVERNMENT"
6570 PRINT UE$; "PRESS RELEVANT NUMBER NOW."
6580 GOSUB 8000  // 8000 = Wait for Key Press
6585 IF A < 1 OR A > 5 THEN 6580
6590 G1 = A
6600 PRINT U5$; "�YOUR GROUP IS ATTEMPTING TO OVERTHROW"
6610 PRINT "A " W$(G1) " GOVERNMENT....IS IT A..."
6620 PRINT UU$; "1...COMMUNIST TAKEOVER BID"
6630 PRINT "2...SOCIALIST TAKEOVER BID"
6640 PRINT "3...LIBERAL   TAKEOVER BID"
6650 PRINT "4...RIGHTWING TAKEOVER BID"
6660 PRINT "5...FASCIST   TAKEOVER BID"
6670 PRINT UE$; "PRESS RELEVANT NUMBER NOW."
6680 GOSUB 8000  // 8000 = Wait for Key Press
6685 IF A < 1 OR A > 5 THEN 6680
6686 IF A <> G1 THEN 6690
6687 PRINT "YOU CAN'T " U5$; "BOTH " UE$; "BE " W$(A) "!"
6688 PRINT "THERE WOULDN'T BE ANY POINT IN HAVING"
6689 PRINT "ANY SORT OF TAKEOVER.  TRY AGAIN.": GOTO 6680
6690 P1 = A
6700 PRINT U5$; "�SO, YOU REPRESENT A " W$(P1) " GROUP"
6705 PRINT "ATTEMPTING TO OVERTHROW A " W$(G1)
6710 PRINT "GOVERNMENT HEADED BY PRESIDENT XERXES."
6715 PRINT UE$; "RIGHT? (PRESS 'Y' OR 'N')
6720 GOSUB 8000  // 8000 = Wait for Key Press
6722 IF A$ = "N" THEN PRINT "�": GOTO 6500
6724 IF A$ = "Y" THEN 6730
6726 GOTO 6720
6730 PRINT UE$ "�";: IF G1 > P1 GOTO 6742
6735 PRINT "SINCE THE GOVERNMENT IS MORE TO"
6736 UN$ = U2$: UM$ = U4$: UN = U2: UM = U4
6737 PRINT "THE LEFT THAN YOUR TAKE OVER BID,"
6738 PRINT "THE GOVERNMENT FORCES WILL BE " U7$; "RED"
6739 PRINT UE$; "    WHILE YOUR FORCES WILL BE " U9$; "BLUE."
6740 GOTO 6750
6742 PRINT "SINCE THE GOVERNMENT IS MORE TO"
6744 PRINT "THE RIGHT THAN YOUR TAKE OVER BID,"
6746 PRINT "THE GOVERNMENT FORCES WILL BE " U9$; "BLUE
6748 PRINT UE$; "    WHILE YOUR FORCES WILL BE " U7$; "RED."
6749 UN$ = U4$: UM$ = U2$: UN = U4: UM = U2
6750 PRINT UE$;
6760 PRINT "DO YOU WANT AN EASY GAME OR A HARD ONE?"
6765 PRINT "IS PRESIDENT XERXES' GOVERNMENT...."
6770 PRINT U3$ "1.....VERY WEAK AND ABOUT TO FALL."
6772 PRINT "2.....WEAK AND UNPOPULAR."
6774 PRINT "3.....REASONABLY SECURE."
6776 PRINT "4.....STABLE AND STRONG."
6777 PRINT "5.....VERY SECURE AND HIGHLY POPULAR."
6778 PRINT UE$; "PRESS RELEVANT NUMBER NOW."
6780 GOSUB 8000  // 8000 = Wait for Key Press
6785 IF A < 1 OR A > 5 THEN 6780
6790 G2 = (A - 1) / 2 + 1.5 + ABS(3 - G1) / 2
6795 P2 = 2.5 + ABS(3 - P1) / 2: PRINT "�"
6900 RETURN

// *** Colour Codes for Commodore 64 ***
7000 REM *****************************
7002 REM COLOUR CODES FOR COMMODORE 64.
7005 REM (ONLY USE THESE COLOURS)
7010 U0 = 0: U0$ = "�": REM BLACK
7020 U1 = 1: U1$ = "": REM WHITE
7030 U2 = 2: U2$ = "": REM DARK RED
7040 U3 = 5: U3$ = "": REM GREEN
7050 U4 = 6: U4$ = "": REM DARK BLUE
7060 U5 = 8: U5$ = "�": REM ORANGE
7070 U6 = 9: U6$ = "�": REM BROWN
7080 U7 = 10: U7$ = "�": REM PINK
7090 U8 = 13: U8$ = "�": REM LIGHT GREEN
7100 U9 = 14: U9$ = "�": REM LIGHT BLUE
7110 UU = 4: UU$ = "�": REM PURPLE
7120 UR = 12: UR$ = "�": REM LIGHT GREY
7130 UE = 7: UE$ = "�": REM LIGHT YELLOW
7140 UF = 0: UF$ = "�": REM BLACK
7150 UQ = 3: UQ$ = "�": REM CYAN

// *** Screen 'Poke' Codes for 64 ***
7200 REM SCREEN 'POKE' CODES FOR 64.
7210 US = 1024: REM SCREEN POKE CHARACTER
7220 UC = 55296: REM SCREEN POKE COLOUR
7230 UG = 53281: REM BACKGROUND COLOUR
7240 UB = 53280: REM SCREEN BORDER COLOUR

// *** Sound 'Poke' Codes for 64 ***
7300 REM SOUND 'POKE' CODES FOR 64.
7310 UV = 54296: REM VOLUME FOR 3 VOICES
7320 UA = 54277: REM ATTACK FOR VOICE 1
7330 UD = 54278: REM SUSTAIN FOR VOICE 1
7340 UH = 54273: REM HIGH BYTE FOR VOICE 1
7350 UL = 54272: REM LOW BYTE FOR VOICE 1
7360 UW = 54276: REM WAVEFORM FOR VOICE 1
7390 PRINT CHR$(142)
7400 RETURN

// *** Wait for Key Press ***
7500 REM *****************************
8000 GET A$: IF A$ <> "" THEN 8000
8010 GET A$: IF A$ = "" THEN 8010
8020 A = VAL(A$): RETURN

// *** Display Message and Wait for Key Press ***
8050 PRINT U6$; "        PRESS ANY KEY TO CONTINUE       "
8055 POKE UV, 15: POKE UA, 154: POKE UD, 12
8056 POKE UH, 5: POKE UL, 15: POKE UW, 17
8060 GOSUB 8000  // 8000 = Wait for Key Press
8065 POKE UV, 0: POKE UA, 0: POKE UD, 0
8066 POKE UH, 0: POKE UL, 0: POKE UW, 0
8070 GOSUB 8200: RETURN  // 8200 = Clear Screen

// *** Draw Map of Buildings ***
8100 REM DRAW MAP OF BUILDINGS
8105 K9 = 1: FOR Y = 1 TO 7: FOR X = 1 TO 11
8110 D$ = "": J = B5(Y, X): IF K9 = 1 THEN 8115
8112 POKE UV, 12: POKE UA, 11: POKE UD, 0
8113 POKE UH, 90 - SGN(J) * 60: POKE UL, 20: POKE UW, 17
8115 IF M5(Y, X) = 0 THEN D$ = UR$ + D9$
8116 IF M5(Y, X) > 0 THEN D$ = UN$ + D9$
8117 IF M5(Y, X) < 0 THEN D$ = UM$ + D9$
8118 IF J = 0 THEN D$ = D$ + D2$: GOTO 8150
8120 D$ = D$ + D1$ + LEFT$(B$(J), 1) + MID$(STR$(S(J)), 2, 1)
8150 PRINT LEFT$(Y$, Y * 3 + 2); LEFT$(X$, (X - 1) * 3); D$; "�";
8155 IF K9 = 0 THEN 8170
8160 NEXT X: PRINT U3$; "�� �"; RIGHT$(STR$(Y), 1); "� �";: NEXT Y
8170 POKE UV, 0: POKE UA, 0: POKE UD, 0
8172 POKE UH, 0: POKE UL, 0: POKE UW, 0
8175 PRINT "": IF K9 = 0 THEN RETURN
8180 K9 = 0
8185 PRINT LEFT$(Y$, 4); U3$; " A  B  C  D  E  F  G  H  I  J  K  "
8190 RETURN

// *** Clear Screen ***
8200 PRINT "                                        "
8210 PRINT "                                        "
8220 PRINT "                                        "
8230 RETURN

// *** Display Popularity Bar Chart ***
8300 PRINT U5$; LEFT$(Y$, 7); LEFT$(X$, 35); "POPUL�����ARITY"
8310 A$ = "H�I�G�H�M�E�D�I�U�M�L�O�W"
8320 PRINT U5$; LEFT$(Y$, 10); LEFT$(X$, 35); A$; ""
8350 REM DISPLAY POPULARITY BAR CHART
8351 IF G2 > 5 THEN G2 = 5
8352 IF P2 > 5 THEN P2 = 5
8353 IF G2 < 1 THEN G2 = 1
8354 IF P2 < 1 THEN P2 = 1
8355 K = 0: FOR J = 1 TO 5 STEP 0.25
8360 IF G2 >= J THEN POKE US + 997 - K, 160: POKE UC + 997 - K, UN: GOTO 8370
8362 IF G2 < J THEN POKE US + 997 - K, 32: POKE UC + 997 - K, UN
8365 IF J - G2 <= .125 THEN POKE US + 997 - K, 98: POKE UC + 997 - K, UN
8370 IF P2 >= J THEN POKE US + 999 - K, 160: POKE UC + 999 - K, UM: GOTO 8380
8372 IF P2 < J THEN POKE US + 999 - K, 32: POKE UC + 999 - K, UM
8375 IF J - P2 <= .125 THEN POKE US + 999 - K, 98: POKE UC + 999 - K, UM
8380 K = K + 40: NEXT J
8390 PRINT UR$; LEFT$(Y$, 4); LEFT$(X$, 34); "POINTS";
8392 PRINT LEFT$(Y$, 5); LEFT$(X$, 35); "";
8393 PRINT UN$; RIGHT$(STR$(G3), 2); "� "; UM$; RIGHT$(STR$(P3), 2)
8394 IF G3 >= 35 OR P3 >= 35 THEN 12000
8395 IF G3 < 0 THEN G3 = 0: GOTO 8390
8396 IF P3 < 0 THEN P3 = 0: GOTO 8390
8399 RETURN

// *** Display Move Number ***
9000 PRINT UM$; "MOVE NO." Q;
9005 PRINT UF$; "�TYPE LETTER/NO. FOR STREET"
9010 PRINT "PRESS KEY 'F1' TO ACTIVATE A BUILDING"
9020 PRINT "'F3':INTELLIGENCE REPORTS   'F5':NO MOVE"
9030 RETURN

// *** Victory ***
12000 REM VICTORY
12100 POKE UV, 15: POKE UA, 155: POKE UD, 216: POKE UW, 33
12110 FOR K = 1 TO 100: POKE UB, U0
12120 POKE UH, K * 2: POKE UH, 0: POKE UB, U1
12130 NEXT K
12135 POKE UV, 0: POKE UA, 0: POKE UD, 0: POKE UW, 0
12137 POKE UH, 0: POKE UH, 0: GOSUB 8200  // 8200 = Clear Screen
12140 IF G3 >= 35 THEN 12500
12200 PRINT UM$; "WELL DONE. YOU HAVE REACHED 35 POINTS"
12210 PRINT "AND THE GOVERNMENT HAS SURRENDERED"
12220 GOSUB 8050: RUN  // 8050 = Display Message and Wait for Key Press
12500 PRINT UN$; "END OF GAME. THE GOVERNMENT HAS REACHED"
12510 PRINT "35 POINTS AND YOU WILL NOW BE SHOT!"
12520 GOSUB 8050: RUN  // 8050 = Display Message and Wait for Key Press
